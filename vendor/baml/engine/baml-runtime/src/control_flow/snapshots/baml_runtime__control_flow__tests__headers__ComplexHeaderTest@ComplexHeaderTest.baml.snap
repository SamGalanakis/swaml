---
source: baml-runtime/src/control_flow/tests.rs
expression: snapshot_value
input_file: baml-runtime/src/control_flow/testdata/ComplexHeaderTest.baml
---
hir: "Some(\n    Block {\n        statements: [\n            HeaderContextEnter(\n                HeaderContext {\n                    level: 1,\n                    title: \"Initialization\",\n                    span: Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 61,\n                        end: 79,\n                    },\n                },\n            ),\n            DeclareAndAssign {\n                name: \"items\",\n                value: Array(\n                    [\n                        StringValue(\n                            \"a\",\n                            Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 97,\n                                end: 100,\n                            },\n                        ),\n                        StringValue(\n                            \"b\",\n                            Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 102,\n                                end: 105,\n                            },\n                        ),\n                        StringValue(\n                            \"c\",\n                            Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 107,\n                                end: 110,\n                            },\n                        ),\n                    ],\n                    Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 96,\n                        end: 111,\n                    },\n                ),\n                annotated_type: None,\n                watch: None,\n                span: Span {\n                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                    start: 84,\n                    end: 113,\n                },\n            },\n            DeclareAndAssign {\n                name: \"result\",\n                value: StringValue(\n                    \"\",\n                    Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 130,\n                        end: 132,\n                    },\n                ),\n                annotated_type: None,\n                watch: None,\n                span: Span {\n                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                    start: 117,\n                    end: 134,\n                },\n            },\n            HeaderContextEnter(\n                HeaderContext {\n                    level: 2,\n                    title: \"Processing Loop\",\n                    span: Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 139,\n                        end: 159,\n                    },\n                },\n            ),\n            ForLoop {\n                identifier: \"item\",\n                iterator: Identifier(\n                    \"items\",\n                    Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 181,\n                        end: 186,\n                    },\n                ),\n                block: Block {\n                    statements: [\n                        HeaderContextEnter(\n                            HeaderContext {\n                                level: 1,\n                                title: \"Markdown Header tester\",\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 199,\n                                    end: 225,\n                                },\n                            },\n                        ),\n                        DeclareAndAssign {\n                            name: \"hello\",\n                            value: StringValue(\n                                \"Hello\",\n                                Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 246,\n                                    end: 253,\n                                },\n                            ),\n                            annotated_type: None,\n                            watch: None,\n                            span: Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 234,\n                                end: 255,\n                            },\n                        },\n                        HeaderContextEnter(\n                            HeaderContext {\n                                level: 3,\n                                title: \"Item Analysis\",\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 264,\n                                    end: 283,\n                                },\n                            },\n                        ),\n                        DeclareAndAssign {\n                            name: \"processed\",\n                            value: NumericValue(\n                                \"2\",\n                                Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 308,\n                                    end: 309,\n                                },\n                            ),\n                            annotated_type: None,\n                            watch: None,\n                            span: Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 292,\n                                end: 311,\n                            },\n                        },\n                        HeaderContextEnter(\n                            HeaderContext {\n                                level: 3,\n                                title: \"Validation\",\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 320,\n                                    end: 336,\n                                },\n                            },\n                        ),\n                        DeclareAndAssign {\n                            name: \"z\",\n                            value: If {\n                                condition: BoolValue(\n                                    true,\n                                    Span {\n                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                        start: 357,\n                                        end: 361,\n                                    },\n                                ),\n                                if_branch: Block(\n                                    Block {\n                                        statements: [\n                                            HeaderContextEnter(\n                                                HeaderContext {\n                                                    level: 1,\n                                                    title: \"Markdown Header tester in statement\",\n                                                    span: Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 378,\n                                                        end: 417,\n                                                    },\n                                                },\n                                            ),\n                                            DeclareAndAssign {\n                                                name: \"hello\",\n                                                value: StringValue(\n                                                    \"Hello\",\n                                                    Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 442,\n                                                        end: 449,\n                                                    },\n                                                ),\n                                                annotated_type: None,\n                                                watch: None,\n                                                span: Span {\n                                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                    start: 430,\n                                                    end: 451,\n                                                },\n                                            },\n                                            HeaderContextEnter(\n                                                HeaderContext {\n                                                    level: 3,\n                                                    title: \"another header in the statement\",\n                                                    span: Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 464,\n                                                        end: 501,\n                                                    },\n                                                },\n                                            ),\n                                            DeclareAndAssign {\n                                                name: \"hello\",\n                                                value: StringValue(\n                                                    \"Hello\",\n                                                    Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 526,\n                                                        end: 533,\n                                                    },\n                                                ),\n                                                annotated_type: None,\n                                                watch: None,\n                                                span: Span {\n                                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                    start: 514,\n                                                    end: 535,\n                                                },\n                                            },\n                                            HeaderContextEnter(\n                                                HeaderContext {\n                                                    level: 3,\n                                                    title: \"True totally\",\n                                                    span: Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 548,\n                                                        end: 566,\n                                                    },\n                                                },\n                                            ),\n                                        ],\n                                        trailing_expr: Some(\n                                            NumericValue(\n                                                \"12\",\n                                                Span {\n                                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                    start: 579,\n                                                    end: 581,\n                                                },\n                                            ),\n                                        ),\n                                    },\n                                    Span {\n                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                        start: 363,\n                                        end: 591,\n                                    },\n                                ),\n                                else_branch: Some(\n                                    Block(\n                                        Block {\n                                            statements: [\n                                                HeaderContextEnter(\n                                                    HeaderContext {\n                                                        level: 1,\n                                                        title: \"False other branch\",\n                                                        span: Span {\n                                                            file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                            start: 611,\n                                                            end: 635,\n                                                        },\n                                                    },\n                                                ),\n                                            ],\n                                            trailing_expr: Some(\n                                                NumericValue(\n                                                    \"13\",\n                                                    Span {\n                                                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                                        start: 648,\n                                                        end: 650,\n                                                    },\n                                                ),\n                                            ),\n                                        },\n                                        Span {\n                                            file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                            start: 597,\n                                            end: 660,\n                                        },\n                                    ),\n                                ),\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 353,\n                                    end: 660,\n                                },\n                            },\n                            annotated_type: None,\n                            watch: None,\n                            span: Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 345,\n                                end: 662,\n                            },\n                        },\n                        HeaderContextEnter(\n                            HeaderContext {\n                                level: 2,\n                                title: \"very useful header\",\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 671,\n                                    end: 694,\n                                },\n                            },\n                        ),\n                        DeclareAndAssign {\n                            name: \"hello2\",\n                            value: StringValue(\n                                \"Hello\",\n                                Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 716,\n                                    end: 723,\n                                },\n                            ),\n                            annotated_type: None,\n                            watch: None,\n                            span: Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 703,\n                                end: 725,\n                            },\n                        },\n                        HeaderContextEnter(\n                            HeaderContext {\n                                level: 3,\n                                title: \"Result\",\n                                span: Span {\n                                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                    start: 734,\n                                    end: 746,\n                                },\n                            },\n                        ),\n                    ],\n                    trailing_expr: Some(\n                        Identifier(\n                            \"result\",\n                            Span {\n                                file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                                start: 755,\n                                end: 761,\n                            },\n                        ),\n                    ),\n                },\n                span: Span {\n                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                    start: 164,\n                    end: 767,\n                },\n            },\n            HeaderContextEnter(\n                HeaderContext {\n                    level: 1,\n                    title: \"Final Processing\",\n                    span: Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 773,\n                        end: 793,\n                    },\n                },\n            ),\n            DeclareAndAssign {\n                name: \"final_result\",\n                value: NumericValue(\n                    \"213\",\n                    Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 817,\n                        end: 820,\n                    },\n                ),\n                annotated_type: None,\n                watch: None,\n                span: Span {\n                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                    start: 798,\n                    end: 822,\n                },\n            },\n            HeaderContextEnter(\n                HeaderContext {\n                    level: 1,\n                    title: \"Return Result\",\n                    span: Span {\n                        file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                        start: 827,\n                        end: 844,\n                    },\n                },\n            ),\n        ],\n        trailing_expr: Some(\n            Identifier(\n                \"final_result\",\n                Span {\n                    file: SourceFile { path: \"src/control_flow/testdata/ComplexHeaderTest.baml\", contents: ... },\n                    start: 849,\n                    end: 861,\n                },\n            ),\n        ),\n    },\n)"
expr:
  nodes:
    "0":
      label: ComplexHeaderTest
      log_filter_key: "ComplexHeaderTest|root:0"
      node_type: function
      parent: ~
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 19
        end: 863
    "1":
      label: Initialization
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
      node_type: header
      parent: "0"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 61
        end: 79
    "10":
      label: another header in the statement
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
      node_type: header
      parent: "9"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 464
        end: 501
    "11":
      label: True totally
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
      node_type: header
      parent: "9"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 548
        end: 566
    "12":
      label: else
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1"
      node_type: branch-arm
      parent: "7"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 597
        end: 660
    "13":
      label: False other branch
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
      node_type: header
      parent: "12"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 611
        end: 635
    "14":
      label: very useful header
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
      node_type: header
      parent: "4"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 671
        end: 694
    "15":
      label: Result
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
      node_type: header
      parent: "14"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 734
        end: 746
    "16":
      label: Final Processing
      log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
      node_type: header
      parent: "0"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 773
        end: 793
    "17":
      label: Return Result
      log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
      node_type: header
      parent: "0"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 827
        end: 844
    "2":
      label: Processing Loop
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
      node_type: header
      parent: "1"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 139
        end: 159
    "3":
      label: for (item in items)
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
      node_type: loop
      parent: "2"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 164
        end: 767
    "4":
      label: Markdown Header tester
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
      node_type: header
      parent: "3"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 199
        end: 225
    "5":
      label: Item Analysis
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
      node_type: header
      parent: "4"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 264
        end: 283
    "6":
      label: Validation
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
      node_type: header
      parent: "4"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 320
        end: 336
    "7":
      label: if (true)
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
      node_type: branch-group
      parent: "6"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 353
        end: 660
    "8":
      label: if (true)
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0"
      node_type: branch-arm
      parent: "7"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 363
        end: 591
    "9":
      label: Markdown Header tester in statement
      log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
      node_type: header
      parent: "8"
      span:
        file: src/control_flow/testdata/ComplexHeaderTest.baml
        start: 378
        end: 417
  edges:
    "1":
      - "16"
    "10":
      - "11"
    "16":
      - "17"
    "5":
      - "6"
    "6":
      - "14"
mermaid: "flowchart TD\nsubgraph n0[\"0: ComplexHeaderTest\"]\n  direction TB\n  subgraph n1[\"1: Initialization\"]\n    direction TB\n    subgraph n2[\"2: Processing Loop\"]\n      direction TB\n      subgraph n3[\"3: Loop: for (item in items)\"]\n        direction TB\n        subgraph n4[\"4: Markdown Header tester\"]\n          direction TB\n          n5[\"5: Item Analysis\"]\n          subgraph n6[\"6: Validation\"]\n            direction TB\n            subgraph n7[\"7: BranchGroup: if (true)\"]\n              direction TB\n              subgraph n8[\"8: BranchArm: if (true)\"]\n                direction TB\n                subgraph n9[\"9: Markdown Header tester in statement\"]\n                  direction TB\n                  n10[\"10: another header in the statement\"]\n                  n11[\"11: True totally\"]\n                  n10 --> n11\n                end\n              end\n              subgraph n12[\"12: BranchArm: else\"]\n                direction TB\n                n13[\"13: False other branch\"]\n              end\n            end\n          end\n          subgraph n14[\"14: very useful header\"]\n            direction TB\n            n15[\"15: Result\"]\n          end\n          n5 --> n6\n          n6 --> n14\n        end\n      end\n    end\n  end\n  n16[\"16: Final Processing\"]\n  n17[\"17: Return Result\"]\n  n1 --> n16\n  n16 --> n17\nend\n"
flattening:
  pass1_remove_implicit:
    label: Remove implicit nodes
    expr:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "12":
          label: else
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1"
          node_type: branch-arm
          parent: "7"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 597
            end: 660
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "12"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "8":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0"
          node_type: branch-arm
          parent: "7"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 363
            end: 591
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "8"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
    json:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "12":
          label: else
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1"
          node_type: branch-arm
          parent: "7"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 597
            end: 660
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "12"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "8":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0"
          node_type: branch-arm
          parent: "7"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 363
            end: 591
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "8"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
    mermaid: "flowchart TD\nsubgraph n0[\"0: ComplexHeaderTest\"]\n  direction TB\n  subgraph n1[\"1: Initialization\"]\n    direction TB\n    subgraph n2[\"2: Processing Loop\"]\n      direction TB\n      subgraph n3[\"3: Loop: for (item in items)\"]\n        direction TB\n        subgraph n4[\"4: Markdown Header tester\"]\n          direction TB\n          n5[\"5: Item Analysis\"]\n          subgraph n6[\"6: Validation\"]\n            direction TB\n            subgraph n7[\"7: BranchGroup: if (true)\"]\n              direction TB\n              subgraph n8[\"8: BranchArm: if (true)\"]\n                direction TB\n                subgraph n9[\"9: Markdown Header tester in statement\"]\n                  direction TB\n                  n10[\"10: another header in the statement\"]\n                  n11[\"11: True totally\"]\n                  n10 --> n11\n                end\n              end\n              subgraph n12[\"12: BranchArm: else\"]\n                direction TB\n                n13[\"13: False other branch\"]\n              end\n            end\n          end\n          subgraph n14[\"14: very useful header\"]\n            direction TB\n            n15[\"15: Result\"]\n          end\n          n5 --> n6\n          n6 --> n14\n        end\n      end\n    end\n  end\n  n16[\"16: Final Processing\"]\n  n17[\"17: Return Result\"]\n  n1 --> n16\n  n16 --> n17\nend\n"
  pass2_hoist_branch_arms:
    label: Hoist branch arms
    expr:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "12":
          label: else
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1"
          node_type: branch-arm
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 597
            end: 660
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "12"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "8":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0"
          node_type: branch-arm
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 363
            end: 591
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "8"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
        "7":
          - "12"
          - "8"
    json:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "12":
          label: else
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1"
          node_type: branch-arm
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 597
            end: 660
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "12"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "8":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0"
          node_type: branch-arm
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 363
            end: 591
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "8"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
        "7":
          - "12"
          - "8"
    mermaid: "flowchart TD\nsubgraph n0[\"0: ComplexHeaderTest\"]\n  direction TB\n  subgraph n1[\"1: Initialization\"]\n    direction TB\n    subgraph n2[\"2: Processing Loop\"]\n      direction TB\n      subgraph n3[\"3: Loop: for (item in items)\"]\n        direction TB\n        subgraph n4[\"4: Markdown Header tester\"]\n          direction TB\n          n5[\"5: Item Analysis\"]\n          subgraph n6[\"6: Validation\"]\n            direction TB\n            n7[\"7: BranchGroup: if (true)\"]\n            subgraph n8[\"8: BranchArm: if (true)\"]\n              direction TB\n              subgraph n9[\"9: Markdown Header tester in statement\"]\n                direction TB\n                n10[\"10: another header in the statement\"]\n                n11[\"11: True totally\"]\n                n10 --> n11\n              end\n            end\n            subgraph n12[\"12: BranchArm: else\"]\n              direction TB\n              n13[\"13: False other branch\"]\n            end\n            n7 --> n8\n            n7 --> n12\n          end\n          subgraph n14[\"14: very useful header\"]\n            direction TB\n            n15[\"15: Result\"]\n          end\n          n5 --> n6\n          n6 --> n14\n        end\n      end\n    end\n  end\n  n16[\"16: Final Processing\"]\n  n17[\"17: Return Result\"]\n  n1 --> n16\n  n16 --> n17\nend\n"
  pass3_flatten_scopes:
    label: Flatten branch arms & scopes
    expr:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
        "7":
          - "13"
          - "9"
    json:
      nodes:
        "0":
          label: ComplexHeaderTest
          log_filter_key: "ComplexHeaderTest|root:0"
          node_type: function
          parent: ~
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 19
            end: 863
        "1":
          label: Initialization
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 61
            end: 79
        "10":
          label: another header in the statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:another-header-in-the-statement:0"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 464
            end: 501
        "11":
          label: True totally
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0|hdr:true-totally:1"
          node_type: header
          parent: "9"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 548
            end: 566
        "13":
          label: False other branch
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:else:1|hdr:false-other-branch:0"
          node_type: header
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 611
            end: 635
        "14":
          label: very useful header
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 671
            end: 694
        "15":
          label: Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:very-useful-header:2|hdr:result:0"
          node_type: header
          parent: "14"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 734
            end: 746
        "16":
          label: Final Processing
          log_filter_key: "ComplexHeaderTest|root:0|hdr:final-processing:1"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 773
            end: 793
        "17":
          label: Return Result
          log_filter_key: "ComplexHeaderTest|root:0|hdr:return-result:2"
          node_type: header
          parent: "0"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 827
            end: 844
        "2":
          label: Processing Loop
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0"
          node_type: header
          parent: "1"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 139
            end: 159
        "3":
          label: for (item in items)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0"
          node_type: loop
          parent: "2"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 164
            end: 767
        "4":
          label: Markdown Header tester
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0"
          node_type: header
          parent: "3"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 199
            end: 225
        "5":
          label: Item Analysis
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:item-analysis:0"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 264
            end: 283
        "6":
          label: Validation
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1"
          node_type: header
          parent: "4"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 320
            end: 336
        "7":
          label: if (true)
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0"
          node_type: branch-group
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 353
            end: 660
        "9":
          label: Markdown Header tester in statement
          log_filter_key: "ComplexHeaderTest|root:0|hdr:initialization:0|hdr:processing-loop:0|loop:for-item-in-items:0|hdr:markdown-header-tester:0|hdr:validation:1|bg:if-true:0|arm:if-true:0|hdr:markdown-header-tester-in-statement:0"
          node_type: header
          parent: "6"
          span:
            file: src/control_flow/testdata/ComplexHeaderTest.baml
            start: 378
            end: 417
      edges:
        "1":
          - "16"
        "10":
          - "11"
        "16":
          - "17"
        "5":
          - "6"
        "6":
          - "14"
        "7":
          - "13"
          - "9"
    mermaid: "flowchart TD\nsubgraph n0[\"0: ComplexHeaderTest\"]\n  direction TB\n  subgraph n1[\"1: Initialization\"]\n    direction TB\n    subgraph n2[\"2: Processing Loop\"]\n      direction TB\n      subgraph n3[\"3: Loop: for (item in items)\"]\n        direction TB\n        subgraph n4[\"4: Markdown Header tester\"]\n          direction TB\n          n5[\"5: Item Analysis\"]\n          subgraph n6[\"6: Validation\"]\n            direction TB\n            n7[\"7: BranchGroup: if (true)\"]\n            subgraph n8[\"9: Markdown Header tester in statement\"]\n              direction TB\n              n9[\"10: another header in the statement\"]\n              n10[\"11: True totally\"]\n              n9 --> n10\n            end\n            n11[\"13: False other branch\"]\n            n7 --> n8\n            n7 --> n11\n          end\n          subgraph n12[\"14: very useful header\"]\n            direction TB\n            n13[\"15: Result\"]\n          end\n          n5 --> n6\n          n6 --> n12\n        end\n      end\n    end\n  end\n  n14[\"16: Final Processing\"]\n  n15[\"17: Return Result\"]\n  n1 --> n14\n  n14 --> n15\nend\n"
